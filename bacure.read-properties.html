<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>bacure.read-properties documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Bacure</span> <span class="project-version">1.2.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bacure</span></div></div></li><li class="depth-2"><a href="bacure.coerce.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coerce</span></div></a></li><li class="depth-3 branch"><a href="bacure.coerce.obj.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>obj</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>service</span></div></div></li><li class="depth-4 branch"><a href="bacure.coerce.service.acknowledgement.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>acknowledgement</span></div></a></li><li class="depth-4"><a href="bacure.coerce.service.confirmed.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>confirmed</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>type</span></div></div></li><li class="depth-4 branch"><a href="bacure.coerce.type.constructed.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>constructed</span></div></a></li><li class="depth-4 branch"><a href="bacure.coerce.type.enumerated.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>enumerated</span></div></a></li><li class="depth-4 branch"><a href="bacure.coerce.type.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-4"><a href="bacure.coerce.type.primitive.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>primitive</span></div></a></li><li class="depth-2 branch"><a href="bacure.core.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="bacure.events.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>events</span></div></a></li><li class="depth-2 branch"><a href="bacure.local-device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>local-device</span></div></a></li><li class="depth-2 branch"><a href="bacure.local-save.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>local-save</span></div></a></li><li class="depth-2 branch"><a href="bacure.network.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>network</span></div></a></li><li class="depth-2 branch current"><a href="bacure.read-properties.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>read-properties</span></div></a></li><li class="depth-2 branch"><a href="bacure.remote-device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>remote-device</span></div></a></li><li class="depth-2 branch"><a href="bacure.serial-connection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serial-connection</span></div></a></li><li class="depth-2 branch"><a href="bacure.services.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>services</span></div></a></li><li class="depth-2 branch"><a href="bacure.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-2"><a href="bacure.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="bacure.read-properties.html#var-assemble-arrays"><div class="inner"><span>assemble-arrays</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-assemble-results"><div class="inner"><span>assemble-results</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-BACnet-array.3F"><div class="inner"><span>BACnet-array?</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-compact-obj-prop-ref"><div class="inner"><span>compact-obj-prop-ref</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-expand-array"><div class="inner"><span>expand-array</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-expand-obj-prop-ref"><div class="inner"><span>expand-obj-prop-ref</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-find-max-refs"><div class="inner"><span>find-max-refs</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-is-expanded-array.3F"><div class="inner"><span>is-expanded-array?</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-partition-object-property-references"><div class="inner"><span>partition-object-property-references</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-array-in-chunks"><div class="inner"><span>read-array-in-chunks</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-array-individually"><div class="inner"><span>read-array-individually</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-individually"><div class="inner"><span>read-individually</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-properties"><div class="inner"><span>read-properties</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-properties-multiple-objects"><div class="inner"><span>read-properties-multiple-objects</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-property-multiple"><div class="inner"><span>read-property-multiple</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-property-multiple*"><div class="inner"><span>read-property-multiple*</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-property-multiple-request"><div class="inner"><span>read-property-multiple-request</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-property-request"><div class="inner"><span>read-property-request</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-range"><div class="inner"><span>read-range</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-range-request"><div class="inner"><span>read-range-request</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-range-request-by"><div class="inner"><span>read-range-request-by</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-single-property"><div class="inner"><span>read-single-property</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-read-single-property-with-fallback"><div class="inner"><span>read-single-property-with-fallback</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-replace-special-identifier"><div class="inner"><span>replace-special-identifier</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-size-related.3F"><div class="inner"><span>size-related?</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-split-opr"><div class="inner"><span>split-opr</span></div></a></li><li class="depth-1"><a href="bacure.read-properties.html#var-when-coll"><div class="inner"><span>when-coll</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">bacure.read-properties</h1><div class="doc"><pre class="plaintext"></pre></div><div class="public anchor" id="var-assemble-arrays"><h3>assemble-arrays</h3><div class="usage"><code>(assemble-arrays data)</code></div><div class="doc"><pre class="plaintext">Reassemble arrays from data returned from a
read-property-multiple.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L114">view source</a></div></div><div class="public anchor" id="var-assemble-results"><h3>assemble-results</h3><div class="usage"><code>(assemble-results results)</code></div><div class="doc"><pre class="plaintext">For each object-identifier, check if a property is present is
present more than once. If it is, we are most probably dealing with
a segmented array... just concat them together.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L230">view source</a></div></div><div class="public anchor" id="var-BACnet-array.3F"><h3>BACnet-array?</h3><div class="usage"><code>(BACnet-array? data)</code></div><div class="doc"><pre class="plaintext">Return true if the raw data returned by a read property is part of
an array.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L109">view source</a></div></div><div class="public anchor" id="var-compact-obj-prop-ref"><h3>compact-obj-prop-ref</h3><div class="usage"><code>(compact-obj-prop-ref obj-prop-refs)</code></div><div class="doc"><pre class="plaintext">Inverse of 'expand-obj-prop-ref'.
</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L268">view source</a></div></div><div class="public anchor" id="var-expand-array"><h3>expand-array</h3><div class="usage"><code>(expand-array local-device-id device-id object-identifier property-reference)</code><code>(expand-array local-device-id device-id object-identifier property-reference size)</code></div><div class="doc"><pre class="plaintext">Ask the remote device what is the length of the BACnet array and
return as many object-property-identifiers. If object is not an
array (or any other error), return nil.

An array length can be provided to avoid a request to a remote device.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L46">view source</a></div></div><div class="public anchor" id="var-expand-obj-prop-ref"><h3>expand-obj-prop-ref</h3><div class="usage"><code>(expand-obj-prop-ref obj-prop-refs)</code></div><div class="doc"><pre class="plaintext">Take a normal object-property-references, such as

[ [[:analog-input 0] :description :object-name] ...]

and separate the properties into individual references to obtain:
[ [[:analog-input 0] :description]
  [[:analog-input 0] :object-name] ...]</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L255">view source</a></div></div><div class="public anchor" id="var-find-max-refs"><h3>find-max-refs</h3><div class="usage"><code>(find-max-refs local-device-id device-id)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L164">view source</a></div></div><div class="public anchor" id="var-is-expanded-array.3F"><h3>is-expanded-array?</h3><div class="usage"><code>(is-expanded-array? opr)</code></div><div class="doc"><pre class="plaintext">Return true if the object-property-references is an expanded array
Example :
[[[:device 123] [:object-list 1]]
 [[:device 123] [:object-list 2]]]</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L299">view source</a></div></div><div class="public anchor" id="var-partition-object-property-references"><h3>partition-object-property-references</h3><div class="usage"><code>(partition-object-property-references local-device-id device-id obj-prop-references)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L170">view source</a></div></div><div class="public anchor" id="var-read-array-in-chunks"><h3>read-array-in-chunks</h3><div class="usage"><code>(read-array-in-chunks local-device-id device-id partitioned-array)</code></div><div class="doc"><pre class="plaintext">Read the partitioned arrays in chunks and then assemble them back
together.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L246">view source</a></div></div><div class="public anchor" id="var-read-array-individually"><h3>read-array-individually</h3><div class="usage"><code>(read-array-individually local-device-id device-id object-identifier property-reference)</code></div><div class="doc"><pre class="plaintext">Read a BACnet array one time at the time and re-assemble the result
afterward.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L66">view source</a></div></div><div class="public anchor" id="var-read-individually"><h3>read-individually</h3><div class="usage"><code>(read-individually local-device-id device-id object-property-references)</code></div><div class="doc"><pre class="plaintext">Given a list of object-property-references, return a list of object properties maps.

[[[:analog-input 0] :description]
 [[:analog-input 1] :object-name]
 [[:device 1234] [:object-list 2]]] &lt;---- with array index

----&gt;

({:description "ANALOG INPUT 0", :object-identifier [:analog-input 0]}
 {:object-name "ANALOG INPUT 1", :object-identifier [:analog-input 1]}
 {[:object-list 2] [:analog-input 0], :object-identifier [:device 1234]})</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L132">view source</a></div></div><div class="public anchor" id="var-read-properties"><h3>read-properties</h3><div class="usage"><code>(read-properties device-id object-property-references)</code><code>(read-properties local-device-id device-id object-property-references)</code></div><div class="doc"><pre class="plaintext">Retrieve the property values form a remote device.
 Format for object-property-references should be:

 [ [[:analog-input 0] :description :object-name]   &lt;--- multiple properties
   [[:device 1234] [:object-list 0]]                &lt;--- array access
   [[:analog-ouput 1] :present-value]  ...]

The result will be a collection of objects properties map.

Example:

({:object-identifier [analog-input 1], :present-value 12.23}
 {:object-identifier [analog-input 2], :present-value 24.53, object-name "Analog Input 2"})</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L402">view source</a></div></div><div class="public anchor" id="var-read-properties-multiple-objects"><h3>read-properties-multiple-objects</h3><div class="usage"><code>(read-properties-multiple-objects device-id object-identifiers properties)</code><code>(read-properties-multiple-objects local-device-id device-id object-identifiers properties)</code></div><div class="doc"><pre class="plaintext">A convenience function to retrieve properties for multiple
objects.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L431">view source</a></div></div><div class="public anchor" id="var-read-property-multiple"><h3>read-property-multiple</h3><div class="usage"><code>(read-property-multiple local-device-id device-id obj-prop-references)</code></div><div class="doc"><pre class="plaintext">read-access-specification should be of the form:
 [[object-identifier property-references]
  [object-identifier property-references]]

In case of an error (example :unknown-object), will fallback to
reading everything individually in order to be able to know which
property-reference is problematic.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L313">view source</a></div></div><div class="public anchor" id="var-read-property-multiple*"><h3>read-property-multiple*</h3><div class="usage"><code>(read-property-multiple* local-device-id device-id obj-prop-references)</code></div><div class="doc"><pre class="plaintext">read-access-specification should be of the form:
[[object-identifier property-references]
 [object-identifier property-references]]</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L186">view source</a></div></div><div class="public anchor" id="var-read-property-multiple-request"><h3>read-property-multiple-request</h3><div class="usage"><code>(read-property-multiple-request obj-prop-references)</code></div><div class="doc"><pre class="plaintext">Create a read-property-multiple request.
[[object-identifier property-references]
 [object-identifier property-references]]</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L175">view source</a></div></div><div class="public anchor" id="var-read-property-request"><h3>read-property-request</h3><div class="usage"><code>(read-property-request object-identifier property-reference)</code></div><div class="doc"><pre class="plaintext">Create a read-property request.

[:analog-input 0] :description
[:analog-input 0] [:description 0] &lt;--- with array index</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L28">view source</a></div></div><div class="public anchor" id="var-read-range"><h3>read-range</h3><div class="usage"><code>(read-range local-device-id device-id object-identifier property-identifier array-index [reference range] &amp; by-what?)</code></div><div class="doc"><pre class="plaintext">'by-what?' can be :sequence, :time, or position (the default if
none is provided).</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L476">view source</a></div></div><div class="public anchor" id="var-read-range-request"><h3>read-range-request</h3><div class="usage"><code>(read-range-request object-identifier property-identifier array-index [reference range] &amp; by-what?)</code></div><div class="doc"><pre class="plaintext">'by-what?' can be :sequence, :time, or :position (the default if none is provided).
</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L466">view source</a></div></div><div class="public anchor" id="var-read-range-request-by"><h3>read-range-request-by</h3><div class="usage"><code>(read-range-request-by reference range &amp; by-what)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L456">view source</a></div></div><div class="public anchor" id="var-read-single-property"><h3>read-single-property</h3><div class="usage"><code>(read-single-property local-device-id device-id object-identifier property-reference)</code></div><div class="doc"><pre class="plaintext">Read a single property.
</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L40">view source</a></div></div><div class="public anchor" id="var-read-single-property-with-fallback"><h3>read-single-property-with-fallback</h3><div class="usage"><code>(read-single-property-with-fallback local-device-id device-id object-identifier property-reference)</code></div><div class="doc"><pre class="plaintext">Read a single property. If there's a size-related APDU error, will
try to read the BACnet arrays one item at the time.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L80">view source</a></div></div><div class="public anchor" id="var-replace-special-identifier"><h3>replace-special-identifier</h3><div class="usage"><code>(replace-special-identifier object-property-references)</code></div><div class="doc"><pre class="plaintext">For devices that don't support the special identifiers
(i.e. :all, :required and :optional), return a list of properties.

The :all won't be as the one defined by the BACnet standard,
because we can't know for sure what are the properties. (Especially
in the case of proprietary objects.)</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L274">view source</a></div></div><div class="public anchor" id="var-size-related.3F"><h3>size-related?</h3><div class="usage"><code>(size-related? read-result)</code></div><div class="doc"><pre class="plaintext">True if the abort reason is size related.
</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L72">view source</a></div></div><div class="public anchor" id="var-split-opr"><h3>split-opr</h3><div class="usage"><code>(split-opr obj-prop-references)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L221">view source</a></div></div><div class="public anchor" id="var-when-coll"><h3>when-coll</h3><div class="usage"><code>(when-coll coll f)</code></div><div class="doc"><pre class="plaintext">Apply function 'f' to coll only if it really is a collection.
Return nil otherwise.</pre></div><div class="src-link"><a href="https://github.com/Frozenlock/bacure/blob/1.2.0/src/bacure/read_properties.clj#L288">view source</a></div></div></div></body></html>